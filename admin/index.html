<!doctype html>
<html lang="en"><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin - Users</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:24px}
  header{display:flex;gap:12px;align-items:center;margin-bottom:16px}
  input,button,select{padding:8px 10px}
  table{border-collapse:collapse;width:100%;margin-top:12px}
  th,td{border:1px solid #ddd;padding:8px}
  th{text-align:left}
  h2{margin-top:28px}
</style>
<body>
  <header>
    <h1 style="margin:0">Users</h1>
    <form id="createForm" style="margin-left:auto;display:flex;gap:8px">
      <input type="email" id="email" placeholder="newuser@example.com" required />
      <button type="submit">Create</button>
    </form>
  </header>
  <div id="status"></div>

  <h2>Active</h2>
  <table><thead><tr><th>ID</th><th>Email</th><th>Username</th><th>Account type</th><th>Created</th><th>Actions</th></tr></thead><tbody id="activeRows"></tbody></table>

  <h2>Suspended</h2>
  <table><thead><tr><th>ID</th><th>Email</th><th>Username</th><th>Account type</th><th>Created</th><th>Actions</th></tr></thead><tbody id="suspendedRows"></tbody></table>

  <h2>Deleted</h2>
  <table><thead><tr><th>ID</th><th>Email</th><th>Username</th><th>Account type</th><th>Created</th><th>Actions</th></tr></thead><tbody id="deletedRows"></tbody></table>

  
<script type="module" src="./app.js"></script>

<script>
  (function(){
    console.log('admin bootstrap start');
    // ensure app.js tag exists
    if(!document.querySelector('script[src^="/admin/app.js"]')){
      var s=document.createElement('script');
      s.src='/admin/app.js?v=2afe019'; s.defer=true; document.body.appendChild(s);
      console.log('admin app.js injected');
    }
    // fallback renderer if app.js did not mark execution
    setTimeout(async function(){
      if(!window.__admin_app_ran){
        console.warn('admin fallback renderer active');
        try{
          var r=await fetch('/api/admin/users',{credentials:'include',headers:{'Accept':'application/json'}});
          var ct=r.headers.get('content-type')||'';
          if(!r.ok||ct.indexOf('application/json')<0){ console.warn('api not json/authorized', r.status, ct); return; }
          var j=await r.json(); var items=j.items||j.users||[];
          var tbs=document.querySelectorAll('table tbody');
          if(tbs[0]){
            tbs[0].innerHTML = items.map(function(u){
              return '<tr><td>'+(u.id||'')+'</td><td>'+(u.email||'')+'</td><td>'+(u.username||'')+'</td><td>'+(u.account_type||u.role||'')+'</td><td>'+(u.created_at||'')+'</td><td></td></tr>';
            }).join('');
          }
          console.log('fallback rendered', items.length);
        }catch(e){ console.error('fallback error', e); }
      }
    }, 1200);
  })();
</script>
<script src="/admin/app.js?v=2afe019" defer></script>
</body></html>











